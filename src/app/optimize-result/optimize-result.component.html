
<div class="container" id="divContainer">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/explainable-admet/home" title="home">Explainable-Admet</a></li>
          <li class="breadcrumb-item"><a href="/explainable-admet/optimization" title="optimization">optimization</a></li>
          <li class="breadcrumb-item active" aria-current="page">results</li>
        </ol>
    </nav>
    <br>
    <div class="row">
      <div class="col-2">
        <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
          <a class="nav-link active" id="v-pills-optimizing-tab" data-toggle="pill" href="#v-pills-optimizing" role="tab" aria-controls="v-pills-optimizing" aria-selected="true">Optimize</a>
          <a class="nav-link" id="v-pills-prediction-tab" data-toggle="pill" href="#v-pills-prediction" role="tab" aria-controls="v-pills-prediction" aria-selected="false">Predict</a>
        </div>
      </div>
      <div class="col-10">
        <div class="card mb-3" >
          <div class="row no-gutters">
            <div class="col-sm-5">
              <a href="" data-toggle="modal" data-target="#staticBackdrop">
                <img [src]="'data:image/png;base64,'+ result[1].img" class="card-img" alt="optimizedPicture" width=250px; height=350px;>
              </a>
              <div class="row" style="margin-bottom: 5px;">
                <div class="col-sm-3 offset-1">
                  <span style="font-size: 17px; font-family: 'Times New Roman', Times, serif;">RA score:</span>
                </div>
                <div class="col-sm-5" >
                  <div class="progress" style="margin-top: 7px;">
                    <div class="progress-bar progress-bar-striped bg-info" role="progressbar" [style.width]="result[1].score +'%'" [attr.aria-valuenow]="result[1].score" aria-valuemin="0" aria-valuemax="100">{{result[1].score + '%'}}
                    </div>
                  </div>    
                </div>
                <br>
                <br>
                <br>
                
              </div>
            </div>
            <div class="col-sm-7" >
              <div class="card-body">
                <p class="card-text" style="font-size: 18px; font-family: 'Times New Roman', Times, serif;">
                  A bioisostere is a molecule resulting from the exchange of an atom or of a group of atoms with an alternative, broadly similar, atom or group of atoms. The replacement can attenuate toxicity, modify activity of lead, and/or alter pharmacokinetics or the toxicity of the lead. 
                </p>
                <p class="card-text" style="font-size: 18px; font-family: 'Times New Roman', Times, serif;">
                  Optimization function can convert the structure of the compound into a "constant" part and a "variable" part, by comparing the variable part with the structure in the database of your choice, the replacement of biological isosteres can be realized
                </p>
                <p class="card-text" style="font-size: 18px; font-family: 'Times New Roman', Times, serif;">
                  Retrosynthetic Accessibility (RA) score has been trained on 200,000 compounds from ChEMBL. It is intended to predict the retrosyntehtic accessibility of bioactive molecules.
                </p>
                <p class="card-text" style="font-size: 18px; font-family: 'Times New Roman', Times, serif;">
                  If you want to get the Bioisosteres of the compound on the left, please click on it to modify.
                </p>
              
    
                
                <!-- <p class="card-text" style="font-size: 17px; font-family: 'Times New Roman', Times, serif;">Simple replacements</p>
                <div class="row">
                  <div class="col-sm-6">
                    <ul class="card-text">
                      <li>
                        <p>H  &nbsp;&nbsp;  D  &nbsp;&nbsp; F</p>
                      </li>
                      <li>
                        <p>Cl  &nbsp; PH<sub>2  &nbsp;  </sub>  SH   &nbsp;   CN</p>
                      </li>
                      <li>
                        <p>I   &nbsp;&nbsp; tBu    &nbsp;&nbsp; CF<sub>3</sub>  </p>
                      </li>
                      <li>
                        <p>CO<sub>2</sub>R      CONHR       COSR    
                        <br> COCH<sub>2</sub>R</p>
                      </li>
                      <li>
                        <p>C  &nbsp;&nbsp;  Si</p>
                      </li>
                      <li>
                        <p>-OH &nbsp; -F &nbsp; -OMe</p>
                      </li>
                    </ul>
                  </div>
                  <div class="col-sm-6"> 
                    <ul class="card-text">
                      <li>
                        <p>Me &nbsp;  NH<sub>2</sub> &nbsp; OH   &nbsp;   F &nbsp;  Cl</p>
                      </li>
                      <li>
                        <p>Br &nbsp;&nbsp;  iPr &nbsp;&nbsp;   CF<sub>3</sub></p>
                      </li>
                      <li>
                        <p>CH<sub>2</sub>   NH   &nbsp;   O &nbsp;  S</p>
                      </li>
                      <li>
                        <p>-CH=   &nbsp;  -N=   &nbsp;  -S-</p>
                      </li>
                      <li>
                        <p>Phenyl  &nbsp;&nbsp;&nbsp; Pyridyl Thiophene 
                        <br> 4-Fluorophenyl</p>
                      </li>
                      <li>
                        <p>-O- &nbsp;&nbsp;&nbsp; -CF<sub>2</sub>-  &nbsp;  </p>
                      </li>
                    </ul>
                  </div>
                </div> -->
                
              </div>
            </div>
          </div>


          <div class="tab-content" id="v-pills-tabContent">
            <div class="tab-pane fade" id="v-pills-prediction" role="tabpanel" aria-labelledby="v-pills-prediction-tab">
              <div class="card-text col-sm-8 offset-1" style="font-size: 18px; font-family: 'Times New Roman', Times, serif; margin-bottom: 5px;">If you want to predict the properties of it, please click the button 
                <button
                  type="submit"
                  style="color: rgb(79, 5, 153)"
                  class="btn btn-outline-primary col-sm-2 "
                  (click)="predicting()"
                >
                  prediction
                </button>
              </div>
            </div>
            <div class="tab-pane fade show active" id="v-pills-optimizing" role="tabpanel" aria-labelledby="v-pills-optimizing-tab">
              <div class="row">
                <label
                for="DbSelect"
                class="col-sm-2 col-form-label col-form-label-lg offset-1"
                style="font-size: 23px"
                >Property:
                </label>

                <div class="col-sm-3">
                  <select
                    class="form-control form-control-lg"
                    id="DbSelect"
                    name="optDb"
                    [(ngModel)]="choice.db"
                    style="color: rgb(79, 5, 153)"
                  >
                    <option [value]="item" *ngFor="let item of choice.dbs">
                      {{ item }}
                    </option>
                  </select>
                </div>
                
                <label
                for="cutoffSelect"
                class="col-sm-2 col-form-label col-form-label-lg "
                style="font-size: 23px"
                >Cutoff:</label>

                <div class="col-sm-3">
                  <select
                    class="form-control form-control-lg"
                    id="cutoffSelect"
                    name="cutoffname"
                    [(ngModel)]="choice.threshold"
                    style="color: rgb(79, 5, 153)"
                  >
                    <option [value]="item" *ngFor="let item of choice.thresholds">
                      {{ item }}
                    </option>
                  </select>
                  
                </div>
                <small
                    id="cutoffnameHelp"
                    class="form-text text-muted col-sm-10 offset-1"
                    style="font-size: 17px; margin-bottom: 5px;"
                    >If you want to modify the database corresponding to the <em>attribute and cutoff</em>, please do it before the structure modification</small
                  >
                <!-- <br>
                <br>
                <br>
                <div class="col-sm-9 offset-1">
                  <button
                  type="submit"
                  style="color: rgb(79, 5, 153)"
                  class="btn btn-outline-primary col-sm-3 offset-3"
                  (click)="postData()">
                  optimize
                  </button> 
                </div>-->
                
              </div>
              
            </div>
          </div>
        </div>

        
      </div>
    </div>


    <div class="row" style="margin-top: 25px;"> 
      <div class="col-sm-12" style="border: 1px solid rgb(127, 121, 133); " >
        <table  class="table table-sm table-hover" style="margin: 5px;" id='optimizeTable'>
          <thead class="thead-light">
            <tr>
              <th scope="col">Index</th>
              <th scope="col">Before Transformation</th>
              <th></th>
              <th scope="col">After Transformation</th>
              <th scope="col">Value</th>
            </tr>
          </thead>
          <!-- |slice:0:10 -->
          <tbody>
            <tr *ngFor="let data of result[0];let i=index;">
              <td>{{i + 1}}</td>
              <td>
                <img [src]="'data:image/png;base64,'+ result[1].img" alt="" />
              </td>
              <td >
                <span style="height: auto; width: 50px;"><img src="assets\img\row.svg" alt="row" style="height: auto; width: 50px;" ></span>
                
              </td>
              <td>
                <a (click)="predicting(i)">
                  <img [src]="'data:image/png;base64,'+ data.to_img" alt="" />
                  <!-- <app-jsme [elementId]="'structure_'+i"
                    [width]="'220px'"
                    [height]="'250px'"
                    [option]="'depict nozoom noshowdraganddropsymbolindepictmode'"
                    [molString]="data.smiles"
                  ></app-jsme> -->
                </a>
              </td>
              <!-- noshowdraganddropsymbolindepictmode -->
              <!-- <td >
                <img [src]="'data:image/png;base64,'+ data.from_img" alt="" width="200px" height="200px"/></td>
              <td >
                <img [src]="'data:image/png;base64,'+ data.to_img" alt="" width="200px" height="200px"/></td> -->
              <td>
                <!-- {{data.label_avg}} -->
                {{data.value}}
              </td>
            </tr>
            
          </tbody>
        </table> 
      </div>
      <div class="col-sm-8 offset-2 " style="margin-top: 5px; font-family: 'Times New Roman', Times, serif; font-size: 18px;">
      If you want to download the corresponding file, please click <button type="button" class="btn btn-outline-info" (click)="Download(choice.db)">Download</button> 
      </div>
      <br>
      
    </div>
</div>
<div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Structure modification</h5>
      </div>
      <div class="modal-body">
        <app-jsme
                [elementId]="'structure-search'"
                [width]="'450px'"
                [height]="'350px'"
                [showDemo]="false"
                [molString] = "result[1].smiles"
                >loading JSME widget
        </app-jsme>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" 
        (click)="postData()">confirm</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="optimizationModal" tabindex="-1" role="dialog" aria-labelledby="optimizationModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="optimizationModalLabel">ERROR</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
       {{optimizeError}}
      </div>
      <div class="modal-footer">
         <button type="button" class="btn btn-secondary" data-dismiss="modal">Comfirm</button>
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="preModal" tabindex="-1" role="dialog" aria-labelledby="preModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="preModalLabel">Error</h5>
      </div>
      <div class="modal-body" style="text-align: center; font-size: 19px; font-family: 'Times New Roman', Times, serif;">
       {{preError}}
      </div>
      <div class="modal-footer">
         <button type="button" class="btn btn-secondary" data-dismiss="modal">Comfirm</button>
      </div>
    </div>
  </div>
</div>



<div class="modal fade" id="loadingModal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="loadingModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" >
    <span style="color: rgb(220, 247, 234); font-size: 20px; font-family: 'Times New Roman', Times, serif;">Calculating, please wait</span>
    &nbsp;&nbsp;&nbsp;
    <div class="spinner-grow text-info" role="status" style="width: 3rem; height: 3rem;">
      <span class="sr-only">Loading...</span>
    </div>
    &nbsp;&nbsp;
    <div class="spinner-grow text-info" role="status" style="width: 2rem; height: 2rem;">
      <span class="sr-only">Loading...</span>
    </div>
    &nbsp;&nbsp;
    <div class="spinner-grow text-info" role="status" style="width: 1rem; height: 1rem;">
      <span class="sr-only">Loading...</span>
    </div>
  </div> 
</div>



